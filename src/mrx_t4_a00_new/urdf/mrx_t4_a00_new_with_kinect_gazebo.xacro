<?xml version="1.0"?>
<robot name="mrx_t4_a00_new" xmlns:xacro="http://www.ros.org/wiki/xacro">

  <xacro:include filename="$(find mrx_t4_a00_new)/urdf/kinect.xacro"/>
  <xacro:property name="kinect_offset_x" value="1.2"/>
  <xacro:property name="kinect_offset_y" value="0.0"/>
  <xacro:property name="kinect_offset_z" value="1.2"/>
  <xacro:property name="M_PI" value="3.141592654"/>

  <!-- fixed frame in gazebo -->
  <link name="world" />
  <joint name="world_base_link_joint" type="fixed">
      <parent link="world" />
      <child link="base_link"/>
  </joint>

  <link name="base_link">
    <!--
    <visual>
      <origin xyz=" 0 0 -0.01"  rpy="0 0 0"/>
      <geometry>
        <box size="1 1 0.02" />
      </geometry>
      <material name="Brown" />
    </visual>
    <collision>
      <origin xyz=" 0 0 -0.01"  rpy="0 0 0"/>
      <geometry>
        <box size="1 1 0.02" />
      </geometry>
    </collision>
    <inertial>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <inertia ixx="1.0" ixy="0.0" ixz="0.0" iyy="0.5" iyz="0.0" izz="1.0" />
      <mass value="500" />
    </inertial>
    -->
  </link>

  <joint name="bottom_joint" type="fixed">
    <origin xyz="0 0 0" rpy="0 0 0" />
    <parent link="base_link"/>
    <child link="base"/>
  </joint>

  <link name="base">
    <inertial>
      <origin xyz="-0.000144936182500289 -0.00820760069399896 0.0989499405919245" rpy="0 0 0" />
      <mass value="2.18102317082151" />
      <inertia
        ixx="0.0113453778745561"
        ixy="4.63289918071108E-05"
        ixz="-4.32363621106919E-06"
        iyy="0.0113991095551259"
        iyz="0.000506283101670542"
        izz="0.00568476675971968" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/base.STL" />
      </geometry>
      <material name="">
        <color rgba="0.752941176470588 0.752941176470588 0.752941176470588 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/base.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="base_to_armA" type="revolute">
    <origin xyz="0 0 0.144" rpy="-1.5708 0 0" />
    <parent link="base" />
    <child link="armA" />
    <axis xyz="0 -1 0" />
    <limit effort="300" velocity="1" lower="-2.75762022" upper="2.75762022" />
  </joint>

  <link name="armA">
    <inertial>
      <origin xyz="-0.058992099688719 -0.0186016047995519 0.0758305002441301" rpy="0 0 0" />
      <mass value="0.303896581928651" />
      <inertia
        ixx="0.001050564841006"
        ixy="-1.55163555383218E-05"
        ixz="-6.26787525019475E-05"
        iyy="0.00302129432156541"
        iyz="3.82579698525422E-05"
        izz="0.00299355685876571" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armA.STL" />
      </geometry>
      <material name="">
        <color rgba="0.752941176470588 0.752941176470588 0.752941176470588 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armA.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="armA_to_armB" type="revolute">
    <origin xyz="0 -0.113 0.03375" rpy="0 -1.5708 0" />
    <parent link="armA" />
    <child link="armB" />
    <axis xyz="-1 0 0" />
    <limit effort="300" velocity="1" lower="-1.51843645" upper="0.48869219" />
  </joint>

  <link
    name="armB">
    <inertial>
      <origin xyz="0.013013 0.020769 0.15495" rpy="0 0 0" />
      <mass value="0.33565" />
      <inertia
        ixx="0.0042212"
        ixy="2.1585E-05"
        ixz="0.00030616"
        iyy="0.0041857"
        iyz="-1.0585E-05"
        izz="0.0011326" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armB.STL" />
      </geometry>
      <material name="">
        <color rgba="0.69804 0.69804 0.69804 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armB.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="armB_to_armC" type="revolute">
    <origin xyz="-0.06375 -0.255 0" rpy="0 1.5708 0" />
    <parent link="armB" />
    <child link="armC" />
    <axis xyz="0 0 -1" />
    <limit effort="300" velocity="1" lower="-1.01229096" upper="3.10668606" />
  </joint>

  <link
    name="armC">
    <inertial>
      <origin xyz="0.12619 -0.01285 0.015821" rpy="0 0 0" />
      <mass value="0.62172" />
      <inertia
        ixx="0.00074736"
        ixy="6.7514E-06"
        ixz="-0.000196"
        iyy="0.0072631"
        iyz="-1.2208E-05"
        izz="0.0066601" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armC.STL" />
      </geometry>
      <material name="">
        <color rgba="0.69804 0.69804 0.69804 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armC.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="armC_to_armD" type="continuous">
    <origin xyz="0.25 0 0.03" rpy="1.5708 0 3.14159" />
    <parent link="armC" />
    <child link="armD" />
    <axis xyz="0 -1 0" />
  </joint>

  <link
    name="armD">
    <inertial>
      <origin xyz="7.533E-05 0.0029979 0.086356" rpy="0 0 0" />
      <mass
        value="0.30492" />
      <inertia
        ixx="0.00080442"
        ixy="2.1974E-06"
        ixz="-3.2773E-07"
        iyy="0.00087792"
        iyz="3.4916E-05"
        izz="0.00023134" />
    </inertial>
    <visual>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armD.STL" />
      </geometry>
      <material name="">
        <color rgba="0.62745 0.41961 0.18824 1" />
      </material>
    </visual>
    <collision>
      <origin xyz="0 0 0" rpy="0 0 0" />
      <geometry>
        <mesh filename="package://mrx_t4_a00_new/meshes/armD.STL" />
      </geometry>
    </collision>
  </link>

  <joint name="armD_to_vthand" type="fixed">
    <origin xyz="0 0 0.15" rpy="1.5708 -1.5708 0"/>
    <parent link="armD"/>
    <child link="vt_hand"/>
  </joint>
  <link name="vt_hand"/>

  <xacro:macro name="tran" params="trans_name joint_name motor_name">
    <transmission name="${trans_name}">
        <type>transmission_interface/SimpleTransmission</type>
        <joint name="${joint_name}">
            <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
            </joint>
            <actuator name="${motor_name}">
                <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
    </transmission>
  </xacro:macro>

  <xacro:tran trans_name="trans1" motor_name="motor1" joint_name="base_to_armA"/>
  <xacro:tran trans_name="trans2" motor_name="motor2" joint_name="armA_to_armB"/>
  <xacro:tran trans_name="trans3" motor_name="motor3" joint_name="armB_to_armC"/>
  <xacro:tran trans_name="trans4" motor_name="motor4" joint_name="armC_to_armD"/>

  <!-- Kinect -->
  <joint name="kinect_frame_joint" type="fixed">
      <origin xyz="${kinect_offset_x} ${kinect_offset_y} ${kinect_offset_z}" rpy="0 ${M_PI/4} ${M_PI}"/>
      <parent link="base_link"/>
      <child link="camera_link"/>
  </joint>
  <xacro:kinect_camera prefix="camera"/>

  <!-- ros_control plugin -->
  <gazebo>
    <plugin name="gazebo_ros_control" filename="libgazebo_ros_control.so">
      <robotNamespace>/arm</robotNamespace>
      <robotSimType>gazebo_ros_control/DefaultRobotHWSim</robotSimType>
    </plugin>
   </gazebo>

  <!-- Link1 -->
  <gazebo reference="base">
    <material>Gazebo/Grey</material>
  </gazebo>

  <!-- Link2 -->
  <gazebo reference="armA">
    <material>Gazebo/Orange</material>
  </gazebo>

  <!-- Link3 -->
  <gazebo reference="armB">
    <material>Gazebo/Orange</material>
  </gazebo>

  <!-- Link4 -->
  <gazebo reference="armC">
    <material>Gazebo/Orange</material>
  </gazebo>

  <!-- Link5 -->
  <gazebo reference="armD">
    <material>Gazebo/Red</material>
  </gazebo>

</robot>
